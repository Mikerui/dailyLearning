var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)}));var t=this;this.app.on("UI:MobWaiJiaClick",function(i){t.entity.enabled&&(t.orbitCamera.distance-=1)}),this.app.on("UI:MobWaiJianClick",function(i){t.entity.enabled&&(t.orbitCamera.distance+=1)}),this.app.on("UI:TouchMoveX",function(i){if(t.entity.enabled){t.lastTouchPoint;t.orbitCamera.yaw-=i*t.orbitSensitivity}})},TouchInput.prototype.getPinchDistance=function(t,i){var n=t.x-i.x,o=t.y-i.y;return Math.sqrt(n*n+o*o)},TouchInput.prototype.calcMidPoint=function(t,i,n){n.set(i.x-t.x,i.y-t.y),n.scale(.5),n.x+=t.x,n.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){if(this.entity.enabled){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))}},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,n=TouchInput.toWorldPoint,o=TouchInput.worldDiff,c=this.entity.camera,h=this.orbitCamera.distance;c.screenToWorld(t.x,t.y,h,i),c.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,h,n),o.sub2(n,i)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){if(this.entity.enabled){var i=TouchInput.pinchMidPoint,n=t.touches;if(1==n.length){var o=n[0];this.orbitCamera.pitch-=(o.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(o.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(o.x,o.y)}else if(2==n.length){var c=this.getPinchDistance(n[0],n[1]),h=c-this.lastPinchDistance;this.lastPinchDistance=c,this.orbitCamera.distance-=h*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(n[0],n[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}}};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,i=function(){t._checkAspectRatio()};window.addEventListener("resize",i,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var e=this.entity.getRotation();if(this._yaw=this._calcYaw(e),this._pitch=this._clampPitchAngle(this._calcPitch(e,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var a=new pc.Vec3;a.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(a.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:distanceMax",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:pitchAngleMin",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:pitchAngleMax",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:focusEntity",function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this.on("attr:frameOnStart",function(t,i){t&&this.focus(this.focusEntity||this.app.root)}),this.on("destroy",function(){window.removeEventListener("resize",i,!1)})},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.aRotation=this.entity.script.autoRotation,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",o,!1)})}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2,this.wheel=-3;t=this;this.app.on("UI:WaiJiaClick",function(o){t.entity.enabled&&(t.orbitCamera.distance+=t.wheel*t.distanceSensitivity*(.1*t.orbitCamera.distance))}),this.app.on("UI:WaiJianClick",function(o){t.entity.enabled&&(t.orbitCamera.distance-=t.wheel*t.distanceSensitivity*(.1*t.orbitCamera.distance))}),this.app.on("UI:MouseDown",function(){t.lookButtonDown=!1,t.panButtonDown=!1})},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,i=MouseInput.toWorldPoint,e=MouseInput.worldDiff,n=this.entity.camera,s=this.orbitCamera.distance;n.screenToWorld(t.x,t.y,s,o),n.screenToWorld(this.lastPoint.x,this.lastPoint.y,s,i),e.sub2(i,o),this.orbitCamera.pivotPoint.add(e)},MouseInput.prototype.onMouseDown=function(t){if(this.entity.enabled)switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:}},MouseInput.prototype.onMouseUp=function(t){if(this.entity.enabled)switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput.prototype.onMouseMove=function(t){if(this.entity.enabled){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity,this.aRotation.ResetTime()):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)}},MouseInput.prototype.onMouseWheel=function(t){this.entity.enabled&&(this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault())},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInput.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInput.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(this.orbitCamera.reset(this.startYaw,this.startPitch,this.startDistance),this.orbitCamera.pivotPoint=this.startPivotPosition)};pc.extend(pc,function(){var t=function(t){this._app=t,this._tweens=[],this._add=[]};t.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var i=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.EASE_LINEAR,this._sv={},this._ev={}};i.prototype={to:function(t,i,e,s,n,r){return t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return t instanceof pc.Quat?this._properties={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Vec3?this._properties={x:t.x,y:t.y,z:t.z}:t instanceof pc.Color?(this._properties={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(this._properties.a=t.a)):this._properties=t,this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(var t in this._properties)this._sv[t]=this._properties[t],this._ev[t]=this.target[t];if(this._slerp){this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z);var i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z;this._fromQuat.setFromEulerAngles(i,e,s)}}else{for(var t in this._properties)this._sv[t]=this.target[t],this._ev[t]=this._properties[t];if(this._slerp){this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z);i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z;this._toQuat.setFromEulerAngles(i,e,s)}}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=this.time/this.duration,r=this.easing(n);for(var h in this._properties)e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r;if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtify(!0),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties)tmp=this._sv[i],this._sv[i]=this._ev[i],this._ev[i]=tmp;this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var e=function(t){return 1-s(1-t)},s=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:t,Tween:i,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){return t*t*(2.70158*t-1.70158)},BackOut:function(t){return--t*t*(2.70158*t+1.70158)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:e,BounceOut:s,BounceInOut:function(t){return t<.5?.5*e(2*t):.5*s(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4)*.5+1)}}}()),function(){var t=pc.Application.getApplication();t&&(t._tweenManager=new pc.TweenManager(t),t.on("update",function(i){t._tweenManager.update(i)}),pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.on("destroy",function(){e.stop()}),i&&i.element&&(e.element=element),e})}();var SpritesheetTexture=pc.createScript("spriteSheetTexture");SpritesheetTexture.attributes.add("materialAsset",{type:"asset",assetType:"material",title:"Material Asset"}),SpritesheetTexture.attributes.add("frameCount",{type:"number",default:1,title:"Frame Count"}),SpritesheetTexture.attributes.add("width",{type:"number",default:1,title:"Width",description:"Number of frames wide"}),SpritesheetTexture.attributes.add("height",{type:"number",default:1,title:"Height",description:"Number of frames high"}),SpritesheetTexture.prototype.initialize=function(){this.frame=0,this.transform=new pc.Vec4,this.updateMaterial(0)},SpritesheetTexture.prototype.update=function(t){this.app.mouse.wasPressed(pc.MOUSEBUTTON_LEFT)&&(this.frame=(this.frame+1)%this.frameCount,this.updateMaterial(this.frame))},SpritesheetTexture.prototype.updateMaterial=function(t){var e=1/this.width,r=1/this.height,a=t%this.width,i=Math.floor(t/this.width),s=this.entity.model.meshInstances;this.transform.set(e,r,a*e,1-r-i*r);for(var h=0;h<s.length;++h)s[h].setParameter("texture_diffuseMapTransform",this.transform.data),s[h].setParameter("texture_emissiveMapTransform",this.transform.data),s[h].setParameter("texture_opacityMapTransform",this.transform.data)};var Hotspot=pc.createScript("hotspot");Hotspot.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Hotspot.attributes.add("radius",{type:"number",title:"Radius"}),Hotspot.attributes.add("clickenable",{type:"boolean",default:!1,title:"鍏佽鐐瑰嚮"}),Hotspot.prototype.initialize=function(){this.hitArea=new pc.BoundingSphere(this.entity.getPosition(),this.radius),this.ray=new pc.Ray,this.defaultForwardDirection=this.entity.forward.clone(),this.directionToCamera=new pc.Vec3,this.sprite=this.entity.children[0],this.clickenable&&this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.touch&&this.clickenable&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this)},Hotspot.prototype.update=function(t){var i=this.cameraEntity.getPosition();this.entity.lookAt(i)},Hotspot.prototype.doRayCast=function(t){this.sprite.enabled&&(this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip,this.ray.direction),this.ray.origin.copy(this.cameraEntity.getPosition()),this.ray.direction.sub(this.ray.origin).normalize(),this.hitArea.intersectsRay(this.ray))},Hotspot.prototype.onMouseDown=function(t){t.button==pc.MOUSEBUTTON_LEFT&&this.doRayCast(t)},Hotspot.prototype.onTouchStart=function(t){1==t.touches.length&&(this.doRayCast(t.touches[0]),t.event.preventDefault())};var Ui=pc.createScript("ui");Ui.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),Ui.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),Ui.attributes.add("mcss",{type:"asset",assetType:"css",title:"phone CSS Asset"}),Ui.attributes.add("mhtml",{type:"asset",assetType:"html",title:"phone HTML Asset"}),Ui.attributes.add("rootEntity",{type:"entity",title:"鏍瑰璞�"}),Ui.attributes.add("isWaiguan",{type:"boolean",default:!0,title:"鏄惁澶栬"}),Ui.prototype.initialize=function(){this.currColor=0,this.neishi_color=0,this.neishi_position=0;var e=document.createElement("style");document.head.appendChild(e),e.innerHTML=(pc.platform.mobile?this.mcss.resource:this.css.resource)||"";var t=document.createElement("script");scriptHtml="var _jcq = _jcq || [];",scriptHtml+="_jcq.enableHeatmap = true; ",scriptHtml+="_jcq.push(['_setAccount', '7b2a8feb15cb4fe5bb395fa6d1e8095c']);",scriptHtml+="_jcq.push(['_host', 'jeep.com.cn']); ",scriptHtml+="(function() { ",scriptHtml+="var jc = document.createElement('script'); jc.async = true;",scriptHtml+="jc.src = '//' + 'cdn.jice.io/js/jice.min.js';",scriptHtml+="var s = document.getElementsByTagName('script')[0];",scriptHtml+="s.parentNode.insertBefore(jc, s);",scriptHtml+="})(); ",t.innerHTML=scriptHtml,document.head.appendChild(t),this.div=document.createElement("div"),pc.platform.mobile?(this.div.classList.add("con"),this.div.innerHTML=this.mhtml.resource||""):(this.div.classList.add("barcon"),this.div.innerHTML=this.html.resource||""),document.body.appendChild(this.div),pc.platform.mobile?this.bindEventsM():this.bindEvents()},Ui.prototype.clearStyle=function(e){for(var t=0;t<e.length;++t){var i=e[t];i.classList.length>2&&i.classList.remove(i.classList.item(2))}},Ui.prototype.setToNomal=function(e){for(var t=0;t<e.length;++t){var i=e[t];i.setAttribute("src",i.getAttribute("srcnormal"))}},Ui.prototype.bindEventsM=function(){var e=this;this.div.querySelector(".btnlight").addEventListener("click",function(t){e.rootEntity.script.carObj.lightToggle(),_jcq.push(["_track","mk8_kd"])}),this.div.querySelector(".btnlun").addEventListener("click",function(t){e.rootEntity.script.carObj.runWheelToggle(),_jcq.push(["_track","mk8_lp"])}),this.div.querySelector(".btnneishi").addEventListener("click",function(e){_jcq.push(["_track","mk8_ckns"]),window.parent&&window.parent.ChangeFrameUrl&&(e.currentTarget.classList.length<2?window.parent.ChangeFrameUrl(1):window.parent.ChangeFrameUrl(0))}),this.isWaiguan?(e.div.querySelector(".waidiv").style.display="block",e.div.querySelector(".neidiv").style.display="none"):(e.div.querySelector(".waidiv").style.display="none",e.div.querySelector(".neidiv").style.display="block",this.div.querySelector(".btnneishi").classList.add("btnchangewai")),this.div.querySelector(".waidiv .tableft").addEventListener("click",function(){e.div.querySelector(".con1").style.display="block",e.div.querySelector(".con2").style.display="none",e.div.querySelector(".con3").style.display="none",e.div.querySelector(".waidiv .tabright").classList.remove("on"),e.div.querySelector(".waidiv .tableft").classList.add("on"),e.div.querySelector(".waidiv .tabcenter").classList.remove("on")}),this.div.querySelector(".waidiv .tabcenter").addEventListener("click",function(){e.div.querySelector(".con2").style.display="block",e.div.querySelector(".con1").style.display="none",e.div.querySelector(".con3").style.display="none",e.div.querySelector(".waidiv .tabright").classList.remove("on"),e.div.querySelector(".waidiv .tableft").classList.remove("on"),e.div.querySelector(".waidiv .tabcenter").classList.add("on")}),this.div.querySelector(".waidiv .tabright").addEventListener("click",function(){e.div.querySelector(".con3").style.display="block",e.div.querySelector(".con1").style.display="none",e.div.querySelector(".con2").style.display="none",e.div.querySelector(".waidiv .tabright").classList.add("on"),e.div.querySelector(".waidiv .tableft").classList.remove("on"),e.div.querySelector(".waidiv .tabcenter").classList.remove("on"),e._checkWapAspectRatio(),_jcq.push(["_track","mK8_tyqzkj"])}),this.div.querySelector(".neidiv .tableft").addEventListener("click",function(){e.div.querySelector(".con3").style.display="block",e.div.querySelector(".con4").style.display="none",e.div.querySelector(".neidiv .tabright").setAttribute("src",e.div.querySelector(".neidiv .tabright").getAttribute("srcnormal")),e.div.querySelector(".neidiv .tableft").setAttribute("src",e.div.querySelector(".neidiv .tableft").getAttribute("srcon"))}),this.div.querySelector(".neidiv .tabright").addEventListener("click",function(){e.div.querySelector(".con4").style.display="block",e.div.querySelector(".con3").style.display="none",e.div.querySelector(".neidiv .tabright").setAttribute("src",e.div.querySelector(".neidiv .tabright").getAttribute("srcon")),e.div.querySelector(".neidiv .tableft").setAttribute("src",e.div.querySelector(".neidiv .tableft").getAttribute("srcnormal"))});for(var t=this.div.querySelector(".con3").querySelectorAll("img"),i=0;i<t.length;i++)t[i].addEventListener("click",function(t){var i=t.currentTarget,r=i.getAttribute("color"),c=i.getAttribute("rel");e.neishi_color=r;for(var o=e.div.querySelector(".con3").querySelectorAll("img"),n=0;n<o.length;n++){var s=o[n].getAttribute("oimg"),l=o[n].getAttribute("onimg");n==c?o[n].setAttribute("src",l):o[n].setAttribute("src",s)}e.rootEntity.script.neiObj.changePosition(e.neishi_color,e.neishi_position)});var r=this.div.querySelector(".con1").querySelectorAll("img");for(i=0;i<r.length;i++)r[i].addEventListener("click",function(t){var i=t.currentTarget;e.currColor=i.getAttribute("coloridx");for(var r=parseInt(i.getAttribute("rel")),c=e.div.querySelector(".con1").querySelectorAll("img"),o=0;o<c.length;o++){var n=c[o].getAttribute("oimg"),s=c[o].getAttribute("onimg");o==r?c[o].setAttribute("src",s):c[o].setAttribute("src",n)}e.rootEntity.script.carObj.changeCarColor(e.currColor),0==r&&_jcq.push(["_track","mk8_zs"]),1==r&&_jcq.push(["_track","mk8_white"]),2==r&&_jcq.push(["_track","mk8_black"]),3==r&&_jcq.push(["_track","mk8_grey"]),4==r&&_jcq.push(["_track","mk8_red"]),5==r&&_jcq.push(["_track","mk8_blue"])});var c=this.div.querySelector(".con4").querySelectorAll("img");for(i=0;i<c.length;i++)c[i].addEventListener("click",function(t){var i=t.currentTarget,r=i.getAttribute("position"),c=i.getAttribute("rel");e.neishi_position=r;for(var o=e.div.querySelector(".con4").querySelectorAll("img"),n=0;n<o.length;n++){var s=o[n].getAttribute("oimg"),l=o[n].getAttribute("onimg");n==c?o[n].setAttribute("src",l):o[n].setAttribute("src",s)}e.rootEntity.script.neiObj.changePosition(e.neishi_color,e.neishi_position)});for(c=this.div.querySelector(".con2").querySelectorAll("img"),i=0;i<c.length;i++)c[i].addEventListener("click",function(t){for(var i=t.currentTarget,r=i.getAttribute("position"),c=i.getAttribute("rel"),o=e.div.querySelector(".con2").querySelectorAll("img"),n=0;n<o.length;n++){var s=o[n].getAttribute("oimg"),l=o[n].getAttribute("onimg");n==c?o[n].setAttribute("src",l):o[n].setAttribute("src",s)}e.rootEntity.script.carObj.showWheel(parseInt(r))});this.div.querySelector(".btnexit").addEventListener("click",function(e){window.parent&&window.parent.VisibleMask&&window.parent.VisibleMask(!0)});var o=0,n=!1;this.div.querySelector(".waidiv .con3 .slider").addEventListener("touchstart",function(t){n=!0,o=t.touches[0].screenX,e.app.fire("UI:MouseDown"),e._checkWapAspectRatio(),t.preventDefault()}),window.addEventListener("touchmove",function(t){if(n){var i=parseFloat(e.div.querySelector(".waidiv .con3").offsetWidth),r=parseFloat(e.div.querySelector(".waidiv .con3 .slider").offsetLeft),c=t.touches[0].screenX-o;o=t.touches[0].screenX,r+=c;var s=-.02*i,l=.82*i,a=parseFloat(e.div.querySelector(".waidiv .con3 .slider").offsetWidth);r<s&&(r=s),r>(l=l-a-a/2)&&(r=l),e.div.querySelector(".waidiv .con3 .slider").style.left=r+"px",e.div.querySelector(".waidiv .con3 .slideBg").style.width=r-3*s+"px";var d=(r-s)/(-s+l);e.app.fire("Car:Opacity",d),e.app.fire("UI:MouseDown"),t.preventDefault()}}),window.addEventListener("touchend",function(e){n=!1});window.addEventListener("resize",function(){e._checkWapAspectRatio()},!1)},Ui.prototype._checkWapAspectRatio=function(){var e=this.div.querySelector(".waidiv .con3 .line").offsetWidth;this.div.querySelector(".waidiv .con3 .slideBg .imgbg").style.width=e+"px"},Ui.prototype.bindEvents=function(){var e=this;this.div.querySelector(".wai_div").querySelector(".wai_light").addEventListener("click",function(t){e.rootEntity.script.carObj.lightToggle(),_jcq.push(["_track","k8_kd"])}),this.div.querySelector(".wai_div").querySelector(".wai_run").addEventListener("click",function(t){e.rootEntity.script.carObj.runWheelToggle(),_jcq.push(["_track","k8_lp"])}),this.div.querySelector(".wai_div").querySelector(".wai_goneishi").addEventListener("click",function(e){_jcq.push(["_track","k8_ckns"]),window.parent&&window.parent.ChangeFrameUrl&&window.parent.ChangeFrameUrl(1)}),this.div.querySelector(".wai_div").querySelector(".con1").querySelector(".img0").addEventListener("click",function(t){e.div.querySelector(".wai_div").querySelector(".con1").style.display="none",e.div.querySelector(".wai_div").querySelector(".con2").style.display="block"}),this.div.querySelector(".wai_div").querySelector(".con1").querySelector(".img1").addEventListener("click",function(t){e.div.querySelector(".wai_div").querySelector(".con1").style.display="none",e.div.querySelector(".wai_div").querySelector(".con3").style.display="block"}),this.isWaiguan?(this.div.querySelector(".wai_div").style.display="block",this.div.querySelector(".nei_div").style.display="none"):(this.div.querySelector(".wai_div").style.display="none",this.div.querySelector(".nei_div").style.display="block");for(var t=this.div.querySelector(".wai_div").querySelector(".con2").querySelectorAll(".img"),i=0;i<t.length;i++)t[i].addEventListener("click",function(i){for(var r=i.currentTarget,c=(r.getAttribute("oimg"),r.getAttribute("onimg")),o=(r.getAttribute("himg"),r.getAttribute("rel")),n=r.getAttribute("widx"),s=0;s<t.length;s++){var l=t[s].getAttribute("oimg");t[s].setAttribute("src",l),t[s].classList.remove("on")}r.classList.add("on"),r.setAttribute("src",c);e.rootEntity.script.carObj.showWheel(n),e.div.querySelector(".wai_div").querySelector(".con1").querySelector(".img0").setAttribute("src",["../k8ui/pc/images/a1d1.png","../k8ui/pc/images/a1d1_1.png","../k8ui/pc/images/a1d1_2.png"][o])}),t[i].addEventListener("mouseover",function(e){var t=e.currentTarget,i=(t.getAttribute("oimg"),t.getAttribute("onimg"),t.getAttribute("himg"));0==t.classList.contains("on")&&t.setAttribute("src",i)}),t[i].addEventListener("mouseout",function(e){var t=e.currentTarget,i=t.getAttribute("oimg");t.getAttribute("onimg"),t.getAttribute("himg");0==t.classList.contains("on")&&t.setAttribute("src",i)});this.div.querySelector(".wai_div").querySelector(".con2").querySelector(".close").addEventListener("click",function(t){e.div.querySelector(".wai_div").querySelector(".con1").style.display="block",e.div.querySelector(".wai_div").querySelector(".con2").style.display="none"});for(var r=this.div.querySelector(".wai_div").querySelector(".con3").querySelectorAll(".img"),c=0;c<r.length;c++)r[c].addEventListener("click",function(t){var i=t.currentTarget;e.currColor=i.getAttribute("coloridx");for(var r=parseInt(i.getAttribute("rel")),c=0;c<=5;c++){var o=e.div.querySelector(".wai_div").querySelector(".con3").querySelector(".img"+c),n=o.getAttribute("oimg"),s=o.getAttribute("onimg");c==r?(o.classList.add("on"),o.setAttribute("src",s),e.div.querySelector(".wai_div").querySelector(".con1").querySelector(".img1").setAttribute("src","../k8ui/pc/images/a1d2_"+r+".png")):(o.classList.remove("on"),o.setAttribute("src",n))}console.log(i),e.rootEntity.script.carObj.changeCarColor(e.currColor),0==r&&_jcq.push(["_track","k8_zs"]),1==r&&_jcq.push(["_track","k8_white"]),2==r&&_jcq.push(["_track","k8_black"]),3==r&&_jcq.push(["_track","k8_grey"]),4==r&&_jcq.push(["_track","k8_red"]),5==r&&_jcq.push(["_track","k8_blue"])}),r[c].addEventListener("mouseover",function(e){var t=e.currentTarget,i=(t.getAttribute("oimg"),t.getAttribute("onimg"),t.getAttribute("himg"));0==t.classList.contains("on")&&t.setAttribute("src",i)}),r[c].addEventListener("mouseout",function(e){var t=e.currentTarget,i=t.getAttribute("oimg");t.getAttribute("onimg"),t.getAttribute("himg");0==t.classList.contains("on")&&t.setAttribute("src",i)});this.div.querySelector(".wai_div").querySelector(".con3").querySelector(".close").addEventListener("click",function(t){e.div.querySelector(".wai_div").querySelector(".con1").style.display="block",e.div.querySelector(".wai_div").querySelector(".con3").style.display="none"}),this.div.querySelector(".nei_div").querySelector(".nei_gowaishi").addEventListener("click",function(e){window.parent.ChangeFrameUrl(0)}),this.div.querySelector(".nei_div").querySelector(".con1").querySelector(".img0").addEventListener("click",function(t){e.div.querySelector(".nei_div").querySelector(".con1").style.display="none",e.div.querySelector(".nei_div").querySelector(".con2").style.display="block"}),this.div.querySelector(".nei_div").querySelector(".con1").querySelector(".img1").addEventListener("click",function(t){e.div.querySelector(".nei_div").querySelector(".con1").style.display="none",e.div.querySelector(".nei_div").querySelector(".con3").style.display="block"});var o=this.div.querySelector(".nei_div").querySelector(".con2").querySelectorAll(".img");for(c=0;c<o.length;c++)o[c].addEventListener("click",function(t){var i=t.currentTarget,r=i.getAttribute("color"),c=i.getAttribute("rel");e.neishi_color=r;for(var o=e.div.querySelector(".nei_div").querySelector(".con2").querySelectorAll(".img"),n=0;n<o.length;n++){var s=o[n].getAttribute("oimg"),l=o[n].getAttribute("onimg");n==c?(o[n].setAttribute("src",l),o[n].classList.add("on"),e.div.querySelector(".nei_div").querySelector(".con1").querySelector(".img0").setAttribute("src","../k8ui/pc/images/c1b1_"+c+".png")):(o[n].setAttribute("src",s),o[n].classList.remove("on"))}e.rootEntity.script.neiObj.changePosition(e.neishi_color,e.neishi_position)}),o[c].addEventListener("mouseover",function(e){var t=e.currentTarget,i=(t.getAttribute("oimg"),t.getAttribute("onimg"),t.getAttribute("himg"));0==t.classList.contains("on")&&t.setAttribute("src",i)}),o[c].addEventListener("mouseout",function(e){var t=e.currentTarget,i=t.getAttribute("oimg");t.getAttribute("onimg"),t.getAttribute("himg");0==t.classList.contains("on")&&t.setAttribute("src",i)});this.div.querySelector(".nei_div").querySelector(".con2").querySelector(".close").addEventListener("click",function(t){e.div.querySelector(".nei_div").querySelector(".con1").style.display="block",e.div.querySelector(".nei_div").querySelector(".con2").style.display="none"});var n=this.div.querySelector(".nei_div").querySelector(".con3").querySelectorAll(".img");for(c=0;c<n.length;c++)n[c].addEventListener("click",function(t){var i=t.currentTarget,r=i.getAttribute("position"),c=i.getAttribute("rel");e.neishi_position=r;for(var o=e.div.querySelector(".nei_div").querySelector(".con3").querySelectorAll(".img"),n=0;n<o.length;n++){var s=o[n].getAttribute("oimg"),l=o[n].getAttribute("onimg");n==c?(o[n].setAttribute("src",l),o[n].classList.add("on"),e.div.querySelector(".nei_div").querySelector(".con1").querySelector(".img1").setAttribute("src","../k8ui/pc/images/c1b2_"+c+".png")):(o[n].setAttribute("src",s),o[n].classList.remove("on"))}e.rootEntity.script.neiObj.changePosition(e.neishi_color,e.neishi_position)}),n[c].addEventListener("mouseover",function(e){var t=e.currentTarget,i=(t.getAttribute("oimg"),t.getAttribute("onimg"),t.getAttribute("himg"));!1===t.classList.contains("on")&&t.setAttribute("src",i)}),n[c].addEventListener("mouseout",function(e){var t=e.currentTarget,i=t.getAttribute("oimg");t.getAttribute("onimg"),t.getAttribute("himg");!1===t.classList.contains("on")&&t.setAttribute("src",i)});this.div.querySelector(".nei_div").querySelector(".con3").querySelector(".close").addEventListener("click",function(t){e.div.querySelector(".nei_div").querySelector(".con1").style.display="block",e.div.querySelector(".nei_div").querySelector(".con3").style.display="none"}),this.div.querySelector(".wai_exit").addEventListener("click",function(e){window.parent&&window.parent.VisibleMask&&window.parent.VisibleMask(!0)}),this.div.querySelector(".wai_div").querySelector(".con1").querySelector(".img2").addEventListener("click",function(t){e.div.querySelector(".wai_div").querySelector(".con1").style.display="none",e.div.querySelector(".wai_div").querySelector(".con4").style.display="block",e._checkAspectRatio(),_jcq.push(["_track","K8_tyqzkj"])}),this.div.querySelector(".wai_div .con4 .close").addEventListener("click",function(t){e.div.querySelector(".wai_div").querySelector(".con1").style.display="block",e.div.querySelector(".wai_div").querySelector(".con4").style.display="none"});var s=0,l=!1;this.div.querySelector(".wai_div .con4 .move").addEventListener("mousedown",function(t){l=!0,s=t.clientX,e.app.fire("UI:MouseDown"),t.preventDefault(),e._checkAspectRatio()}),window.addEventListener("mousemove",function(t){if(l){var i=parseFloat(e.div.querySelector(".wai_div .con4").offsetWidth),r=parseFloat(e.div.querySelector(".wai_div .con4 .move").offsetLeft),c=t.clientX-s;s=t.clientX;var o=(r+=c)/i*100;o<-2&&(o=-2),o>90&&(o=90),e.div.querySelector(".wai_div .con4 .move").style.left=o+"%",e.div.querySelector(".wai_div .con4 .slideBg").style.width=o+6+"%";var n=100/92*(o+2)/100;e.app.fire("Car:Opacity",n),e.app.fire("UI:MouseDown"),t.preventDefault()}}),window.addEventListener("mouseup",function(e){l=!1}),this.app.on("UI:ResetOPactiy",function(){e.div.querySelector(".wai_div .con4 .move").style.left="90%",e.div.querySelector(".wai_div .con4 .slideBg").style.width="96%"});window.addEventListener("resize",function(){e._checkAspectRatio()},!1)},Ui.prototype._checkAspectRatio=function(){var e=this.div.querySelector(".wai_div .con4").offsetWidth;this.div.querySelector(".wai_div .con4 .slideBg .line").style.width=e+"px"};var AutoRotation=pc.createScript("autoRotation");AutoRotation.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),AutoRotation.prototype.initialize=function(){this.lastRotationTime=5,this.currTime=0,this.orbitCamera=this.entity.script.orbitCamera},AutoRotation.prototype.update=function(t){this.currTime>=this.lastRotationTime?this.orbitCamera.yaw-=-.5*this.orbitSensitivity:this.currTime+=t},AutoRotation.prototype.ResetTime=function(){this.lastRotationTime=this.currTime+5};var AutoRotationObj=pc.createScript("autoRotationObj");AutoRotationObj.attributes.add("xspeed",{type:"number",default:0}),AutoRotationObj.attributes.add("yspeed",{type:"number",default:0}),AutoRotationObj.attributes.add("zspeed",{type:"number",default:0}),AutoRotationObj.prototype.initialize=function(){},AutoRotationObj.prototype.update=function(t){this.entity.rotateLocal(this.xspeed*t,this.yspeed*t,this.zspeed*t)};var ScrollingTexture=pc.createScript("scrollingTexture");ScrollingTexture.attributes.add("materialAsset",{type:"asset"}),ScrollingTexture.attributes.add("speed",{type:"vec2"}),ScrollingTexture.tmp=new pc.Vec2,ScrollingTexture.prototype.initialize=function(){this.materialAsset&&(this.material=this.materialAsset.resource)},ScrollingTexture.prototype.update=function(e){var t=ScrollingTexture.tmp;t.set(this.speed.x,this.speed.y),t.scale(e),this.material.diffuseMapOffset.add(t),this.material.normalMapOffset.add(t),this.material.heightMapOffset.add(t),this.material.emissiveMapOffset.add(t),this.material.update()};var NeiObj=pc.createScript("neiObj");NeiObj.attributes.add("texture_0_0",{type:"asset",assetType:"texture",title:"绗竴寮犲浘鍓嶅潗浣�"}),NeiObj.attributes.add("texture_0_1",{type:"asset",assetType:"texture",title:"绗竴寮犲浘涓潗浣�"}),NeiObj.attributes.add("texture_0_2",{type:"asset",assetType:"texture",title:"绗竴寮犲浘鍚庡潗浣�"}),NeiObj.attributes.add("texture_1_0",{type:"asset",assetType:"texture",title:"绗簩寮犲浘鍓嶅潗浣�"}),NeiObj.attributes.add("texture_1_1",{type:"asset",assetType:"texture",title:"绗簩寮犲浘涓潗浣�"}),NeiObj.attributes.add("texture_1_2",{type:"asset",assetType:"texture",title:"绗簩寮犲浘鍚庡潗浣�"}),NeiObj.attributes.add("texture_2_0",{type:"asset",assetType:"texture",title:"绗笁寮犲浘鍓嶅潗浣�"}),NeiObj.attributes.add("texture_2_1",{type:"asset",assetType:"texture",title:"绗笁寮犲浘涓潗浣�"}),NeiObj.attributes.add("texture_2_2",{type:"asset",assetType:"texture",title:"绗笁寮犲浘鍚庡潗浣�"}),NeiObj.attributes.add("neiEntity",{type:"entity"}),NeiObj.prototype.initialize=function(){this.isRunChange=!1;this.allTextures=[[this.texture_0_0,this.texture_0_1,this.texture_0_2],[this.texture_1_0,this.texture_1_1,this.texture_1_2],[this.texture_2_0,this.texture_2_1,this.texture_2_2]]},NeiObj.prototype.update=function(t){},NeiObj.prototype.changePosition=function(t,e){if(!this.isRunChange){this.isRunChange=!0;var i=this;this.entity.script.changeNeiWaiShi.chageBlock(function(){i.isRunChange=!1;var s=i.neiEntity.model.meshInstances;s[0].material.emissiveMap=i.allTextures[t][e].resource,s[0].material.update()})}};var Halo=pc.createScript("halo");Halo.attributes.add("camera",{type:"entity"}),Halo.attributes.add("unidirectional",{type:"boolean",default:!1}),Halo.attributes.add("addStep",{type:"number",default:0}),Halo.attributes.add("maxOpacity",{type:"number",default:1}),Halo.attributes.add("multipLeft",{type:"number",default:1}),Halo.attributes.add("multipRight",{type:"number",default:1}),Halo.attributes.add("isscale",{type:"boolean",default:!1}),Halo.attributes.add("lookat",{type:"boolean",default:!1}),Halo.tmp=new pc.Vec3,Halo.prototype.initialize=function(){this.plane=this.entity.getChildren()[0],this.parent=this.entity.getParent();var t=this.plane.model.meshInstances[0].material;this.plane.model.meshInstances[0].material=t.clone(),this.material=this.plane.model.meshInstances[0].material},Halo.prototype.update=function(t){var a=Halo.tmp;if(a.copy(this.parent.forward).scale(-1),this.camera&&(this.lookat&&this.entity.lookAt(this.camera.getPosition()),this.unidirectional)){var e=-1*a.dot(this.camera.forward);e<0&&(e=0),this.material.opacity=e,this.material.update(),this.isscale&&this.entity.setLocalScale(e,e,e)}};var CarObj=pc.createScript("carObj");CarObj.attributes.add("ground",{type:"entity"}),CarObj.attributes.add("wheel_0_obj",{type:"entity"}),CarObj.attributes.add("wheel_0_0",{type:"entity"}),CarObj.attributes.add("wheel_0_1",{type:"entity"}),CarObj.attributes.add("wheel_0_2",{type:"entity"}),CarObj.attributes.add("wheel_0_3",{type:"entity"}),CarObj.attributes.add("wheel_1_obj",{type:"entity"}),CarObj.attributes.add("wheel_1_0",{type:"entity"}),CarObj.attributes.add("wheel_1_1",{type:"entity"}),CarObj.attributes.add("wheel_1_2",{type:"entity"}),CarObj.attributes.add("wheel_1_3",{type:"entity"}),CarObj.attributes.add("wheel_2_obj",{type:"entity"}),CarObj.attributes.add("wheel_2_0",{type:"entity"}),CarObj.attributes.add("wheel_2_1",{type:"entity"}),CarObj.attributes.add("wheel_2_2",{type:"entity"}),CarObj.attributes.add("wheel_2_3",{type:"entity"}),CarObj.attributes.add("leftLight",{type:"entity"}),CarObj.attributes.add("rightLight",{type:"entity"}),CarObj.attributes.add("leftBottomLight",{type:"entity"}),CarObj.attributes.add("rightBottomLight",{type:"entity"}),CarObj.attributes.add("carObjs",{type:"entity",assetType:"entity",array:!0,title:"杞﹀璞�"}),CarObj.attributes.add("materialColorBlack",{type:"asset",assetType:"material",title:"榛戣壊"}),CarObj.attributes.add("materialColorGray",{type:"asset",assetType:"material",title:"鐏拌壊"}),CarObj.attributes.add("materialColorBrown",{type:"asset",assetType:"material",title:"妫曡壊"}),CarObj.attributes.add("materialColorWhite",{type:"asset",assetType:"material",title:"鐧借壊"}),CarObj.attributes.add("materialColorBlur",{type:"asset",assetType:"material",title:"钃濊壊"}),CarObj.attributes.add("materialColorRed",{type:"asset",assetType:"material",title:"绾㈣壊"}),CarObj.attributes.add("topEntitys",{type:"entity",assetType:"entity",array:!0,title:"椤堕儴闅愯棌閮ㄤ欢"}),CarObj.prototype.initialize=function(){this.showWheelIndex=0;var e=this;this.allWheel=[this.wheel_0_0,this.wheel_0_1,this.wheel_0_2,this.wheel_0_3,this.wheel_1_0,this.wheel_1_1,this.wheel_1_2,this.wheel_1_3,this.wheel_2_0,this.wheel_2_1,this.wheel_2_2,this.wheel_2_3],this.wheelRun=!1,this.allMaterials=[this.materialColorBlack,this.materialColorGray,this.materialColorBrown,this.materialColorWhite,this.materialColorBlur,this.materialColorRed],this.visibleTop=!1,this.app.on("Car:VisibleTop",function(){e.visibleTop=!e.visibleTop;for(var t=0;t<e.topEntitys.length;t++)e.topEntitys[t].enabled=e.visibleTop}),this.currOpacity=1,this.app.on("Car:Opacity",function(t){console.log(t),e.currOpacity=t;for(var a=0;a<e.topEntitys.length;a++)for(var i=0;i<e.topEntitys[a].model.meshInstances.length;i++){var l=e.topEntitys[a].model.meshInstances[i].material;l.blendType=pc.BLEND_PREMULTIPLIED,-1!=l.name.indexOf("鐜荤拑")?l.opacity=t>.913?.913:t:l.opacity=t,t>=1?-1!=l.name.indexOf("鐜荤拑")?l.blendType=pc.BLEND_PREMULTIPLIED:l.blendType=pc.BLEND_NONE:(l.blendType=pc.BLEND_NORMAL,l.depthWrite=!(t<=.1)),l.update()}});for(var t=0;t<e.topEntitys.length;t++)for(var a=0;a<e.topEntitys[t].model.meshInstances.length;a++){var i=e.topEntitys[t].model.meshInstances[a].material;e.topEntitys[t].model.meshInstances[a].material=i.clone()}this.changeCarColor(2)},CarObj.prototype.update=function(e){},CarObj.prototype.showWheel=function(e){for(var t=0;t<this.allWheel.length;t++)this.allWheel[t].enabled=!1;this.showWheelIndex=e,console.log(e),0==e?(this.wheel_0_obj.enabled=!0,this.wheel_1_obj.enabled=!1,this.wheel_2_obj.enabled=!1,this.wheel_0_0.enabled=!0,this.wheel_0_1.enabled=!0,this.wheel_0_2.enabled=!0,this.wheel_0_3.enabled=!0):1==e?(this.wheel_0_obj.enabled=!1,this.wheel_1_obj.enabled=!0,this.wheel_2_obj.enabled=!1,this.wheel_1_0.enabled=!0,this.wheel_1_1.enabled=!0,this.wheel_1_2.enabled=!0,this.wheel_1_3.enabled=!0):(this.wheel_0_obj.enabled=!1,this.wheel_1_obj.enabled=!1,this.wheel_2_obj.enabled=!0,this.wheel_2_0.enabled=!0,this.wheel_2_1.enabled=!0,this.wheel_2_2.enabled=!0,this.wheel_2_3.enabled=!0)},CarObj.prototype.runWheel=function(e){this.wheelRun=e;for(var t=0;t<this.allWheel.length;t++)this.allWheel[t].script.autoRotationObj.enabled=this.wheelRun;this.ground.enabled=e},CarObj.prototype.runWheelToggle=function(){this.ground.enabled?this.runWheel(!1):this.runWheel(!0)},CarObj.prototype.stopAll=function(){for(var e=0;e<this.allWheel.length;e++)this.allWheel[e].script.autoRotationObj.enabled=!1;this.ground.enabled=!1,this.wheelRun=!1},CarObj.prototype.visibleLight=function(e){this.leftLight.enabled=e,this.rightLight.enabled=e,this.leftBottomLight.enabled=e,this.rightBottomLight.enabled=e},CarObj.prototype.lightToggle=function(){this.leftLight.enabled?this.visibleLight(!1):this.visibleLight(!0)},CarObj.prototype.changeCarColor=function(e){for(var t=this.allMaterials[e],a=0;a<this.carObjs.length;a++)for(var i=0;i<this.carObjs[a].model.meshInstances.length;i++){var l=this.carObjs[a].model.meshInstances[i].material;l&&-1!=l.name.indexOf("杞﹁韩_")&&(this.carObjs[a].model.meshInstances[i].material=t.resource.clone(),l.blendType=pc.BLEND_NONE,l.update())}this.app.fire("Car:Opacity",1),this.app.fire("UI:ResetOPactiy")};var ChangeNeiWaiShi=pc.createScript("changeNeiWaiShi");ChangeNeiWaiShi.attributes.add("ambientColorR",{type:"number"}),ChangeNeiWaiShi.attributes.add("ambientColorG",{type:"number"}),ChangeNeiWaiShi.attributes.add("ambientColorB",{type:"number"}),ChangeNeiWaiShi.attributes.add("weiObjs",{type:"entity"}),ChangeNeiWaiShi.attributes.add("neiObjs",{type:"entity"}),ChangeNeiWaiShi.prototype.initialize=function(){this.currType=0,this.isRun=!1,this.currColorA=0,this.maxColorA=1,this.isFadeIn=!1,this.changeType=0,this.changeCallback=null,this.div=document.createElement("div"),this.div.style.backgroundColor="rgba(0,0,0,0)",this.div.style.width="100%",this.div.style.height="100%",this.div.style.position="fixed",this.div.style.left=0,this.div.style.top=0,this.div.style.zIndex=1e6,this.div.style.display="none",document.body.appendChild(this.div)},ChangeNeiWaiShi.prototype.update=function(i){var t=i;this.isRun&&(0==this.currType?this.isFadeIn?(this.currColorA-=this.maxColorA*t,this.currColorA<=0&&(this.currColorA=0,this.isRun=!1,this.isFadeIn=!1,this.div.style.display="none")):(this.currColorA+=this.maxColorA*t,this.currColorA>=this.maxColorA&&(this.currColorA=this.maxColorA,this.isFadeIn=!0,0==this.changeType?(this.weiObjs.enabled=!0,this.neiObjs.enabled=!1):null!=this.changeCallback&&this.changeCallback())):this.isFadeIn?(this.currColorA-=this.maxColorA*t,this.currColorA<=0&&(this.currColorA=0,this.isRun=!1,this.isFadeIn=!1,this.div.style.display="none")):(this.currColorA+=this.maxColorA*t,this.currColorA>=this.maxColorA&&(this.currColorA=this.maxColorA,this.isFadeIn=!0,0==this.changeType?(this.weiObjs.enabled=!1,this.neiObjs.enabled=!0):null!=this.changeCallback&&this.changeCallback())),this.div.style.backgroundColor="rgba(0,0,0,"+this.currColorA+")")},ChangeNeiWaiShi.prototype.change=function(i){this.isRun||(this.isRun=!0,this.currType=i,this.isFadeIn=!1,this.div.style.display="block",this.changeType=0,this.changeCallback=null)},ChangeNeiWaiShi.prototype.chageBlock=function(i){this.isRun||(this.isRun=!0,this.currType=1,this.isFadeIn=!1,this.div.style.display="block",this.changeType=1,this.changeCallback=i)};var TouchInput360=pc.createScript("touchInput360");TouchInput360.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput360.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput360.attributes.add("minFieldOfView",{type:"number",default:36,title:"鏈€灏忚鐣岃寖鍥�"}),TouchInput360.attributes.add("maxFieldOfView",{type:"number",default:80,title:"鏈€澶ц鐣岃寖鍥�"}),TouchInput360.self=null,TouchInput360.lastOrientation=null,TouchInput360.prototype.initialize=function(){TouchInput360.self=this;this.orbitCamera=this.entity.script.orbitCamera,this.aRotation=this.entity.script.autoRotation,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)})),this.app.on("orienterInput:onOrient",function(t){if(null==TouchInput360.lastOrientation)TouchInput360.lastOrientation=new pc.Vec3,TouchInput360.lastOrientation.x=t.lon,TouchInput360.lastOrientation.y=t.lat;else{var i=t.lon-TouchInput360.lastOrientation.x,n=t.lat-TouchInput360.lastOrientation.y;TouchInput360.lastOrientation.x=t.lon,TouchInput360.lastOrientation.y=t.lat,TouchInput360.self.orbitCamera.yaw+=i,TouchInput360.self.orbitCamera.pitch+=n}})},TouchInput360.prototype.getPinchDistance=function(t,i){var n=t.x-i.x,o=t.y-i.y;return Math.sqrt(n*n+o*o)},TouchInput360.prototype.calcMidPoint=function(t,i,n){n.set(i.x-t.x,i.y-t.y),n.scale(.5),n.x+=t.x,n.y+=t.y},TouchInput360.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput360.fromWorldPoint=new pc.Vec3,TouchInput360.toWorldPoint=new pc.Vec3,TouchInput360.worldDiff=new pc.Vec3,TouchInput360.prototype.pan=function(t){var i=TouchInput360.fromWorldPoint,n=TouchInput360.toWorldPoint,o=TouchInput360.worldDiff,e=this.entity.camera,h=this.orbitCamera.distance;e.screenToWorld(t.x,t.y,h,i),e.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,h,n),o.sub2(n,i)},TouchInput360.pinchMidPoint=new pc.Vec2,TouchInput360.prototype.onTouchMove=function(t){if(0!=this.entity.enabled){this.aRotation.ResetTime();var i=TouchInput360.pinchMidPoint,n=t.touches;if(1==n.length){var o=n[0];this.orbitCamera.pitch-=(o.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(o.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(o.x,o.y)}else if(2==n.length){var e=this.getPinchDistance(n[0],n[1]),h=e-this.lastPinchDistance;this.lastPinchDistance=e;var c=this.entity.camera.fov-h*this.distanceSensitivity;c>=this.maxFieldOfView&&(c=this.maxFieldOfView),c<=this.minFieldOfView&&(c=this.minFieldOfView),this.entity.camera.fov=c,this.calcMidPoint(n[0],n[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}}};var MouseInput360=pc.createScript("mouseInput360");MouseInput360.attributes.add("orbitSensitivity",{type:"number",default:-.1,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput360.attributes.add("distanceSensitivity",{type:"number",default:.6,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput360.attributes.add("minFieldOfView",{type:"number",default:36,title:"鏈€灏忚鐣岃寖鍥�"}),MouseInput360.attributes.add("maxFieldOfView",{type:"number",default:80,title:"鏈€澶ц鐣岃寖鍥�"}),MouseInput360.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.aRotation=this.entity.script.autoRotation,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",o,!1)})}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput360.fromWorldPoint=new pc.Vec3,MouseInput360.toWorldPoint=new pc.Vec3,MouseInput360.worldDiff=new pc.Vec3,MouseInput360.prototype.pan=function(t){var o=MouseInput360.fromWorldPoint,e=MouseInput360.toWorldPoint,i=MouseInput360.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInput360.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:}},MouseInput360.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput360.prototype.onMouseMove=function(t){if(0!=this.entity.enabled){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity,this.aRotation.ResetTime()):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)}},MouseInput360.prototype.onMouseWheel=function(t){var o=t.wheel*this.distanceSensitivity,e=this.entity.camera.fov-o;e>=this.maxFieldOfView&&(e=this.maxFieldOfView),e<=this.minFieldOfView&&(e=this.minFieldOfView),this.entity.camera.fov=e,t.event.preventDefault()},MouseInput360.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};var OrienterInput=pc.createScript("orienterInput");OrienterInput.prototype.initialize=function(){switch(this.lon=0,this.lat=0,this.direction=0,this.fix=0,this.os="",this._orient=this._orient.bind(this),this._change=this._change.bind(this),this.lon=0,this.lat=0,this.direction=window.orientation||0,this.direction){case 0:this.fix=0;break;case 90:this.fix=-270;break;case-90:this.fix=-90}navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?this.os="ios":this.os=navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Linux")?"android":"",this.init(),this.entity.script.on("destroy:orienterInput",function(t){window.removeEventListener("deviceorientation",this._orient,!1),window.removeEventListener("orientationchange",this._change,!1)})},OrienterInput.prototype.init=function(){window.addEventListener("deviceorientation",this._orient,!1),window.addEventListener("orientationchange",this._change,!1)},OrienterInput.prototype._change=function(t){this.direction=window.orientation,this.app.fire("orienterInput:onChange",this.direction)},OrienterInput.prototype.changeDirectionTo=function(t){this.direction=t},OrienterInput.prototype._orient=function(t){switch(this.os){case"ios":switch(this.direction){case 0:this.lon=t.alpha+t.gamma,t.beta>0&&(this.lat=t.beta-90);break;case 90:t.gamma<0?this.lon=t.alpha-90:this.lon=t.alpha-270,t.gamma>0?this.lat=90-t.gamma:this.lat=-90-t.gamma;break;case-90:t.gamma<0?this.lon=t.alpha-90:this.lon=t.alpha-270,t.gamma<0?this.lat=90+t.gamma:this.lat=-90+t.gamma}break;case"android":switch(this.direction){case 0:this.lon=t.alpha+t.gamma+30,t.gamma>90?this.lat=90-t.beta:this.lat=t.beta-90;break;case 90:this.lon=t.alpha-230,t.gamma>0?this.lat=270-t.gamma:this.lat=-90-t.gamma;break;case-90:this.lon=t.alpha-180,this.lat=-90+t.gamma}}this.lon+=this.fix,this.lon%=360,this.lon<0&&(this.lon+=360),this.lon=Math.round(this.lon),this.lat=Math.round(this.lat),this.app.fire("orienterInput:onOrient",{a:Math.round(t.alpha),b:Math.round(t.beta),g:Math.round(t.gamma),lon:this.lon,lat:this.lat,dir:this.direction})};var FollowParentCamera=pc.createScript("followParentCamera");FollowParentCamera.attributes.add("cameraEntity",{type:"entity"}),FollowParentCamera.prototype.initialize=function(){},FollowParentCamera.prototype.update=function(t){this.entity.camera.fov=this.cameraEntity.camera.fov,this.entity.camera.rect=this.cameraEntity.camera.rect,this.entity.camera.aspectRatio=this.cameraEntity.camera.aspectRatio,this.entity.camera.orthoHeight=this.cameraEntity.camera.orthoHeight,this.entity.camera.priority=this.cameraEntity.camera.priority,this.entity.camera.projection=this.cameraEntity.camera.projection,this.entity.camera.horizontalFov=this.cameraEntity.camera.horizontalFov};